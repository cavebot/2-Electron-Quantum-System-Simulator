%!PS-Adobe-3.0
%%Creator: groff version 1.21
%%CreationDate: Tue Sep 24 17:25:25 2013
%%DocumentNeededResources: font Times-Roman
%%DocumentSuppliedResources: procset grops 1.21 0
%%DocumentMedia: plain 595 842 0 () ()
%%BoundingBox: 0 0 595 842
%%Pages: 10 0
%%PageOrder: Ascend
%%Orientation: Portrait
%%EndComments
%%BeginDefaults
%%PageMedia: Default
%%EndDefaults
%%BeginProlog
%%BeginProcSet: PStoPS 1 15
userdict begin
[/showpage/erasepage/copypage]{dup where{pop dup load
 type/operatortype eq{ /PStoPSenablepage cvx 1 index load 1 array astore cvx {} bind /ifelse cvx 4 array astore cvx def}{pop}ifelse}{pop}ifelse}forall /PStoPSenablepage true def
[/letter/legal/executivepage/a4/a4small/b5/com10envelope
 /monarchenvelope/c5envelope/dlenvelope/lettersmall/note
 /folio/quarto/a5]{dup where{dup wcheck{exch{}put}
 {pop{}def}ifelse}{pop}ifelse}forall
/setpagedevice {pop}bind 1 index where{dup wcheck{3 1 roll put}
 {pop def}ifelse}{def}ifelse
/PStoPSmatrix matrix currentmatrix def
/PStoPSxform matrix def/PStoPSclip{clippath}def
/defaultmatrix{PStoPSmatrix exch PStoPSxform exch concatmatrix}bind def
/initmatrix{matrix defaultmatrix setmatrix}bind def
/initclip[{matrix currentmatrix PStoPSmatrix setmatrix
 [{currentpoint}stopped{$error/newerror false put{newpath}}
 {/newpath cvx 3 1 roll/moveto cvx 4 array astore cvx}ifelse]
 {[/newpath cvx{/moveto cvx}{/lineto cvx}
 {/curveto cvx}{/closepath cvx}pathforall]cvx exch pop}
 stopped{$error/errorname get/invalidaccess eq{cleartomark
 $error/newerror false put cvx exec}{stop}ifelse}if}bind aload pop
 /initclip dup load dup type dup/operatortype eq{pop exch pop}
 {dup/arraytype eq exch/packedarraytype eq or
  {dup xcheck{exch pop aload pop}{pop cvx}ifelse}
  {pop cvx}ifelse}ifelse
 {newpath PStoPSclip clip newpath exec setmatrix} bind aload pop]cvx def
/initgraphics{initmatrix newpath initclip 1 setlinewidth
 0 setlinecap 0 setlinejoin []0 setdash 0 setgray
 10 setmiterlimit}bind def
end
%%EndProcSet
%%BeginResource: procset grops 1.21 0
%!PS-Adobe-3.0 Resource-ProcSet
/setpacking where{
pop
currentpacking
true setpacking
}if
/grops 120 dict dup begin
/SC 32 def
/A/show load def
/B{0 SC 3 -1 roll widthshow}bind def
/C{0 exch ashow}bind def
/D{0 exch 0 SC 5 2 roll awidthshow}bind def
/E{0 rmoveto show}bind def
/F{0 rmoveto 0 SC 3 -1 roll widthshow}bind def
/G{0 rmoveto 0 exch ashow}bind def
/H{0 rmoveto 0 exch 0 SC 5 2 roll awidthshow}bind def
/I{0 exch rmoveto show}bind def
/J{0 exch rmoveto 0 SC 3 -1 roll widthshow}bind def
/K{0 exch rmoveto 0 exch ashow}bind def
/L{0 exch rmoveto 0 exch 0 SC 5 2 roll awidthshow}bind def
/M{rmoveto show}bind def
/N{rmoveto 0 SC 3 -1 roll widthshow}bind def
/O{rmoveto 0 exch ashow}bind def
/P{rmoveto 0 exch 0 SC 5 2 roll awidthshow}bind def
/Q{moveto show}bind def
/R{moveto 0 SC 3 -1 roll widthshow}bind def
/S{moveto 0 exch ashow}bind def
/T{moveto 0 exch 0 SC 5 2 roll awidthshow}bind def
/SF{
findfont exch
[exch dup 0 exch 0 exch neg 0 0]makefont
dup setfont
[exch/setfont cvx]cvx bind def
}bind def
/MF{
findfont
[5 2 roll
0 3 1 roll
neg 0 0]makefont
dup setfont
[exch/setfont cvx]cvx bind def
}bind def
/level0 0 def
/RES 0 def
/PL 0 def
/LS 0 def
/MANUAL{
statusdict begin/manualfeed true store end
}bind def
/PLG{
gsave newpath clippath pathbbox grestore
exch pop add exch pop
}bind def
/BP{
/level0 save def
1 setlinecap
1 setlinejoin
DEFS/BPhook known{DEFS begin BPhook end}if
72 RES div dup scale
LS{
90 rotate
}{
0 PL translate
}ifelse
1 -1 scale
}bind def
/EP{
level0 restore
showpage
}def
/DA{
newpath arcn stroke
}bind def
/SN{
transform
.25 sub exch .25 sub exch
round .25 add exch round .25 add exch
itransform
}bind def
/DL{
SN
moveto
SN
lineto stroke
}bind def
/DC{
newpath 0 360 arc closepath
}bind def
/TM matrix def
/DE{
TM currentmatrix pop
translate scale newpath 0 0 .5 0 360 arc closepath
TM setmatrix
}bind def
/RC/rcurveto load def
/RL/rlineto load def
/ST/stroke load def
/MT/moveto load def
/CL/closepath load def
/Fr{
setrgbcolor fill
}bind def
/setcmykcolor where{
pop
/Fk{
setcmykcolor fill
}bind def
}if
/Fg{
setgray fill
}bind def
/FL/fill load def
/LW/setlinewidth load def
/Cr/setrgbcolor load def
/setcmykcolor where{
pop
/Ck/setcmykcolor load def
}if
/Cg/setgray load def
/RE{
findfont
dup maxlength 1 index/FontName known not{1 add}if dict begin
{
1 index/FID ne
2 index/UniqueID ne
and
{def}{pop pop}ifelse
}forall
/Encoding exch def
dup/FontName exch def
currentdict end definefont pop
}bind def
/DEFS 0 def
/EBEGIN{
moveto
DEFS begin
}bind def
/EEND/end load def
/CNT 0 def
/level1 0 def
/PBEGIN{
/level1 save def
translate
div 3 1 roll div exch scale
neg exch neg exch translate
0 setgray
0 setlinecap
1 setlinewidth
0 setlinejoin
10 setmiterlimit
[]0 setdash
/setstrokeadjust where{
pop
false setstrokeadjust
}if
/setoverprint where{
pop
false setoverprint
}if
newpath
/CNT countdictstack def
userdict begin
/showpage{}def
/setpagedevice{}def
mark
}bind def
/PEND{
cleartomark
countdictstack CNT sub{end}repeat
level1 restore
}bind def
end def
/setpacking where{
pop
setpacking
}if
%%EndResource
%%EndProlog
%%BeginSetup
%%BeginFeature: *PageSize Default
<< /PageSize [ 595 842 ] /ImagingBBox null >> setpagedevice
%%EndFeature
%%IncludeResource: font Times-Roman
grops begin/DEFS 1 dict def DEFS begin/u{.001 mul}bind def end/RES 72
def/PL 841.89 def/LS false def/ENC0[/asciicircum/asciitilde/Scaron
/Zcaron/scaron/zcaron/Ydieresis/trademark/quotesingle/Euro/.notdef
/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef
/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef
/.notdef/.notdef/.notdef/space/exclam/quotedbl/numbersign/dollar/percent
/ampersand/quoteright/parenleft/parenright/asterisk/plus/comma/hyphen
/period/slash/zero/one/two/three/four/five/six/seven/eight/nine/colon
/semicolon/less/equal/greater/question/at/A/B/C/D/E/F/G/H/I/J/K/L/M/N/O
/P/Q/R/S/T/U/V/W/X/Y/Z/bracketleft/backslash/bracketright/circumflex
/underscore/quoteleft/a/b/c/d/e/f/g/h/i/j/k/l/m/n/o/p/q/r/s/t/u/v/w/x/y
/z/braceleft/bar/braceright/tilde/.notdef/quotesinglbase/guillemotleft
/guillemotright/bullet/florin/fraction/perthousand/dagger/daggerdbl
/endash/emdash/ff/fi/fl/ffi/ffl/dotlessi/dotlessj/grave/hungarumlaut
/dotaccent/breve/caron/ring/ogonek/quotedblleft/quotedblright/oe/lslash
/quotedblbase/OE/Lslash/.notdef/exclamdown/cent/sterling/currency/yen
/brokenbar/section/dieresis/copyright/ordfeminine/guilsinglleft
/logicalnot/minus/registered/macron/degree/plusminus/twosuperior
/threesuperior/acute/mu/paragraph/periodcentered/cedilla/onesuperior
/ordmasculine/guilsinglright/onequarter/onehalf/threequarters
/questiondown/Agrave/Aacute/Acircumflex/Atilde/Adieresis/Aring/AE
/Ccedilla/Egrave/Eacute/Ecircumflex/Edieresis/Igrave/Iacute/Icircumflex
/Idieresis/Eth/Ntilde/Ograve/Oacute/Ocircumflex/Otilde/Odieresis
/multiply/Oslash/Ugrave/Uacute/Ucircumflex/Udieresis/Yacute/Thorn
/germandbls/agrave/aacute/acircumflex/atilde/adieresis/aring/ae/ccedilla
/egrave/eacute/ecircumflex/edieresis/igrave/iacute/icircumflex/idieresis
/eth/ntilde/ograve/oacute/ocircumflex/otilde/odieresis/divide/oslash
/ugrave/uacute/ucircumflex/udieresis/yacute/thorn/ydieresis]def
/Times-Roman@0 ENC0/Times-Roman RE
userdict/PStoPSxform PStoPSmatrix matrix currentmatrix
 matrix invertmatrix matrix concatmatrix
 matrix invertmatrix put
%%EndSetup
%%Page: (0,1) 1
userdict/PStoPSsaved save put
PStoPSmatrix setmatrix
595.000000 0.271378 translate
90 rotate
0.706651 dup scale
userdict/PStoPSmatrix matrix currentmatrix put
userdict/PStoPSclip{0 0 moveto
 595.000000 0 rlineto 0 842.000000 rlineto -595.000000 0 rlineto
 closepath}put initclip
/PStoPSenablepage false def
PStoPSxform concat
showpage
PStoPSsaved restore
userdict/PStoPSsaved save put
PStoPSmatrix setmatrix
595.000000 421.271378 translate
90 rotate
0.706651 dup scale
userdict/PStoPSmatrix matrix currentmatrix put
userdict/PStoPSclip{0 0 moveto
 595.000000 0 rlineto 0 842.000000 rlineto -595.000000 0 rlineto
 closepath}put initclip
PStoPSxform concat
%%BeginPageSetup
BP
%%EndPageSetup
/F0 10/Times-Roman@0 SF 21.294(!!######################################\
############################ !!!)72 84 R 23.793(f=)28.793 G 5
(r^L_\(<\)/r^{L+1}_\(>\), r_\(<\))72 96 R 2.5(=m)2.5 G
(in\(x,r/2\), r_\(>\) = max\(x,r/2\))-2.5 E(PR)72 120 Q(OGRAM H2p)-.4 E
(USE param)77 144 Q(USE set_grid)77 156 Q(USE one_e_matrix)77 168 Q
(USE D)77 180 Q -1.21 -1.11(AT A)-.4 H 2.5(,O)1.11 G(NL)-2.5 E 1.84 -.92
(Y: w)-1 H(rite_mx,write_v_mx).92 E(!..................)77 192 Q(!)77
204 Q(IMPLICIT NONE)77 216 Q 2.5(INTEGER i)77 228 R 2.5(INTEGER l,)77
240 R 112.5(ns !)2.5 F(INTEGER NOUT)77 252 Q 2.5(!I)120 G(/O FILE S)-2.5
E(REAL\(dpk\), ALLOCA)77 264 Q -.93(TA)-1.11 G(BLE, DIMENSION\(:\)).93 E
(:: T)7.5 E 2.5(!B-s)42.5 G(plines grid)-2.5 E(REAL\(dpk\), ALLOCA)77
276 Q -.93(TA)-1.11 G(BLE, DIMENSION\(:,:\) :: B).93 E 2.5(!t)42.5 G
(otal B-splines o)-2.5 E -.15(ve)-.15 G(rlap).15 E(REAL\(dpk\), ALLOCA)
77 288 Q -.93(TA)-1.11 G(BLE, DIMENSION\(:,:\) :: H0).93 E 2.5(!t)40 G
(otal diagonal \(in l,l'\) hamiltonian)-2.5 E(REAL\(dpk\), ALLOCA)77 300
Q -.93(TA)-1.11 G(BLE, DIMENSION\(:,:\) :: V).93 E 2.5(!c)42.5 G
(oupling l')-2.5 E 2.5(sp)-.55 G(otential)-2.5 E(REAL\(dpk\), ALLOCA)77
312 Q -.93(TA)-1.11 G(BLE, DIMENSION\(:\)).93 E(:: en, en_b, en_c)7.5 E
2.5(!e)10 G(ner)-2.5 E(gy v)-.18 E(ectors i = 1,2,..,ns)-.15 E
(REAL\(dpk\), ALLOCA)77 324 Q -.93(TA)-1.11 G
(BLE, DIMENSION\(:,:\) :: ce, ce_b, ce_c).93 E 2.5(!c)10 G(oef)-2.5 E
(\214cients for state en\(i\) !)-.25 E(CHARA)77 336 Q(CTER*100 ARGV !)
-.4 E(EXTERN)5 E(AL f)-.35 E 2.5(!e)72 360 S -.15(xe)-2.65 G
(cutable statements !).15 E(NOUT = 16)77 384 Q(OPEN\(NOUT)77 396 Q
(,FILE='out/h1e.log'\) !)-.74 E(!)5 E(CALL input)77 408 Q
(!get parameters \(parameter)60 E(.f90\) !)-.55 E(!)5 E(CALL GET)77 420
Q(ARG\(1, ARGV\))-.93 E(!get ar)35 E(guments)-.18 E(READ\(ARGV)77 432 Q
5(,*\) l0)-1.29 F 2.5(!l=0)42.5 G(,2,4... or 1,3,5...)-2.5 E(CALL GET)77
444 Q(ARG\(2, ARGV\))-.93 E(!get ar)35 E(guments)-.18 E(READ\(ARGV)77
456 Q 5(,*\) nl)-1.29 F 2.5(!.... !)2.5 F(WRITE\(*, '\(a2,1X,a42,2i3,1X\
,E15.2\)'\) "#"," hz1e.f90: Rh1e l0, nl, b_f : ", l0, NL, B_F)77 492 Q
(WRITE\(*, '\(a2,1X,a42,i3\)'\))77 504 Q
("#"," Input \214le: inp/hz1e.inp")10 E(WRITE\(*, '\(a2,1X,a42,i3\)'\))
77 516 Q
("#","!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!")10 E
(WRITE\(*, '\(a2,1X,a42,i3\)'\))77 528 Q 25("#"," partial)10 F -.1(wa)
2.5 G .3 -.15(ve =)-.1 H(", l0).15 E(WRITE\(*, '\(a2,1X,a42,i3\)'\))77
540 Q("#"," nof partial w)10 E -2.25 -.2(av e)-.1 H 7.5(sn).2 G 2.5(l=)
-7.5 G(", nl)-2.5 E(WRITE\(*, '\(a2,1X,a42,E15.2\)'\) "#",")77 552 Q
(magnetic \214eld b_f =", b_f)12.5 E 5(!!)72 576 S 7.5(.. allocations!)
-5 F 5(!!)5 G(ALLOCA)77 600 Q 22.5(TE\( T\(NB)-1.11 F 2.5(+K)2.5 G
(B\) \))-2.5 E 7.5(!g)25 G(rid knot points)-7.5 E(ALLOCA)77 612 Q 2.5
(TE\( B\()-1.11 F(NL * \(NB-1\), NL*\(NB-1\)\) \))2.5 E 2.5(!t)5 G
(otal hamiltonian)-2.5 E(ALLOCA)77 624 Q
(TE\( H0\( NL * \(NB-1\), NL*\(NB-1\)\) \))-1.11 E 2.5(!t)5 G
(otal hamiltonian)-2.5 E(ALLOCA)77 636 Q 2.5(TE\( V\()-1.11 F
(NL * \(NB-1\), NL*\(NB-1\)\) \))2.5 E 2.5(!t)5 G(otal hamiltonian)-2.5
E 5(!!)72 660 S 2.5(... ! !)-5 F(CALL R_GRID)77 684 Q 2.5(!s)77.5 G
(elect knot-sequence)-2.5 E(CALL MKGRID\()77 696 Q
(NB, KB, RMAX, RS, T \))5 E 2.5(!m)17.5 G(ak)-2.5 E 2.5(eg)-.1 G(rid)
-2.5 E 5.386(!!!)72 720 S .387
(Construct matrix representations of operators on B-spline basis !)-2.5
F 15.387(!H)5.387 G 2.887(=H)-12.5 G .387(_0 + V)-2.887 F(\(V)17.887 E
2.887(:c)-.74 G(oupling)-2.887 E 0 Cg EP
PStoPSsaved restore
%%Page: (2,3) 2
userdict/PStoPSsaved save put
PStoPSmatrix setmatrix
595.000000 0.271378 translate
90 rotate
0.706651 dup scale
userdict/PStoPSmatrix matrix currentmatrix put
userdict/PStoPSclip{0 0 moveto
 595.000000 0 rlineto 0 842.000000 rlineto -595.000000 0 rlineto
 closepath}put initclip
/PStoPSenablepage false def
PStoPSxform concat
%%BeginPageSetup
BP
%%EndPageSetup
/F0 10/Times-Roman@0 SF(-2-)282.17 48 Q .892(part\) !)72 84 R 3.392(!H)
5.892 G .892(_0 = -1/2 d^2/dr^2 + l*\(l+1\)/2r^2 + Za/r !)-3.392 F 3.392
(!n)5.892 G .892(ote: thus the 1-e radial Hamiltonian includes the)
-3.392 F(Coulombing potential of the nuclei.)72 96 Q(!)5 E 5
(CALL MAKE_B\()77 132 R 2.5(t, b)2.5 F 55(\)!)2.5 G(construct b)-52.5 E
2.5(CALL MAKE_H0\()77 144 R(t, h0 \))2.5 E 2.5(!c)55 G(onstruct h0)-2.5
E(!????)77 168 Q 5(!I)77 180 S(F\(code=='bs_fx'\) THEN)-5 E 12.5(!h)77
192 S 2.5(0=2)-12.5 G(.0_dpk*h0)-2.5 E 5(!E)77 204 S(NDIF)-5 E
(IF\(nl.EQ.1\) THEN)77 228 Q(CALL WRITE_MX\(L0, H0, "hmx-"\))84.5 240 Q
(CALL WRITE_MX\(L0,)84.5 252 Q(B, "bmx-"\))5 E(ENDIF)77 264 Q 2.5(!c)72
300 S(onstruct potential v\(r\))-2.5 E 2.5(v=0)77 324 S 67.5(.0_dpk !)
-2.5 F -.05(hy)2.5 G(drogen \(def).05 E(ault\))-.1 E
(IF\( problem == '1eb'\) THEN)77 348 Q 2.83(CALL MAKE_V_MA)84.5 360 R
.33(GNETIC\( t, v)-.4 F 15.33(\)!)5.33 G .33
(Hydrogen in static magnetic \214eld !)-12.5 F .33
(WRITE\(*,*\) "stop",v)12.83 F 12.5(!s)72 372 S(top)-12.5 E
(ELSE IF\( problem == 'h2p'\) THEN)77 384 Q 2.5(CALL MAKE_V_MOLECULAR\()
84.5 396 R(t, v\))2.5 E(!molecular h)17.5 E(ydrogen ion \(h2+\))-.05 E
(ENDIF)77 408 Q 5(!E)72 432 S(LSE IF\( problem == '2e'\) THEN !)-5 E 2.5
(CALL MAKE_V_2e\()12.5 F(t, v\))2.5 E(!helium !)35 E(ENDIF)5 E 7.341(!!)
72 456 S(solv)-2.5 E 4.841(eS)-.15 G 2.341(chrodinger Equation!)-4.841 F
40.159 7.341(!! H)7.341 H 4.841(*C=)-2.5 G 2.34(E*B*C !)-.001 F 34.84
(or A\(E\)*)17.34 F 4.84(C=C)4.84 G(_0,)-4.84 E(A\(E\) = H - E * B !)72
468 Q(IF\(method.EQ.)77 504 Q -.1('l)-.7 G('\) THEN).1 E 2.5(!l)35 G
(inear equations method)-2.5 E 2.5(\(P)10 G(\(R\) free \))-2.5 E
(ns = nbs + ncs)84.5 528 Q(ALLOCA)84.5 552 Q(TE\( EN\(NS\) \))-1.11 E
(ALLOCA)84.5 564 Q(TE\( CE\(NS, NL*\(NB-1\)\) \))-1.11 E 2.5
(CALL ENERGY_SPECTR)84.5 588 R(UM\( L0, EN, 'OUT'\))-.4 E 2.5(!c)32.5 G
(alculate en\(i\))-2.5 E(CALL LINEARIZE_F07BEF\( H0,)84.5 600 Q
(B, EN, CE\))5 E 2.5(!s)30 G(olv)-2.5 E 2.5(ef)-.15 G(or en>0)-2.5 E
(ELSE IF\(method == ')77 624 Q(d'\) THEN)-.5 E 2.5(!d)17.5 G
(iagonalization method \( P\(R\) fxd)-2.5 E(\(==0\) \))5 E(ALLOCA)84.5
648 Q(TE\( EN\( NL*\(NB-2\) \)\))-1.11 E(ALLOCA)84.5 660 Q
(TE\( CE\( NL*\(NB-2\), NL*\(NB-1\)\) \))-1.11 E 12.5(!C)72 708 S
(ALL DIA)-12.5 E(GON)-.4 E(ALIZE_F02FHF\( H, B \))-.35 E
(!get en\(i\) and C\(i\))42.5 E 0 Cg EP
PStoPSsaved restore
userdict/PStoPSsaved save put
PStoPSmatrix setmatrix
595.000000 421.271378 translate
90 rotate
0.706651 dup scale
userdict/PStoPSmatrix matrix currentmatrix put
userdict/PStoPSclip{0 0 moveto
 595.000000 0 rlineto 0 842.000000 rlineto -595.000000 0 rlineto
 closepath}put initclip
PStoPSxform concat
showpage
PStoPSsaved restore
%%Page: (4,5) 3
userdict/PStoPSsaved save put
PStoPSmatrix setmatrix
595.000000 0.271378 translate
90 rotate
0.706651 dup scale
userdict/PStoPSmatrix matrix currentmatrix put
userdict/PStoPSclip{0 0 moveto
 595.000000 0 rlineto 0 842.000000 rlineto -595.000000 0 rlineto
 closepath}put initclip
/PStoPSenablepage false def
PStoPSxform concat
%%BeginPageSetup
BP
%%EndPageSetup
/F0 10/Times-Roman@0 SF(-18-)279.67 48 Q(ENDIF)87 84 Q(END SUBR)82 96 Q
(OUTINE ENERGY_SPECTR)-.4 E(UM)-.4 E 35.225(END PR)77 132 R 35.225
(OGRAM H2P !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!! EOF)-.4 F
3.977(!################################################################\
### ! laan jan/feb 2003)72 144 R .145(iesl day)72 156 R 2.644(:b)5.145 G
.144(sp1ef/h1e.f90 !)-2.644 F -5.144 5.144(!! A)5.144 H 20.144(uthor :)
-5.144 F .144(Lambros Nik)7.644 F .144(olopoulos !)-.1 F 2.644(:!)45.144
G 10.144(!J)-2.644 G .144(AN/FEB 2003 : !)-10.744 F -2.845 5.345(:! I)72
168 T 2.845(/0 \214les)-5.345 F 10.345(:i)17.845 G 2.845(np/h1e.inp !)
-10.345 F 10.345(:o)47.845 G 2.846(ut/h1e.out !)-10.345 F 10.346(:o)
47.846 G 2.846(ut/setmat.log !)-10.346 F(:)47.846 E(out/subsolv)72 180 Q
.14(e.lin.out !)-.15 F 7.64(:o)45.14 G(ut/subsolv)-7.64 E(e.in)-.15 E
-.65(v.)-.4 G .14(out !).65 F -.14 2.64(:! I)45.14 H .14
(/O data \214les :)-2.64 F -.4(DA)7.64 G(T/HD1E-L.LIN-)-.71 E -.4(DA)72
192 S 9.699 -.74(T, L)-.71 H 5.719(=0)6.459 G 5.719(,1)-5.719 G 8.219
(,.)-5.719 G 3.219(.., NL !)-8.219 F 10.719(:D)48.219 G -1.11(AT)-11.119
G(/HD1E-L.INV)1.11 E(.D)-1.29 E -1.02 -1.11(AT ,)-.4 H 5.72(L=0)9.329 G
5.72(,1)-5.72 G 8.22(,.)-5.72 G 3.22(.., NL !)-8.22 F(:)48.22 E -.4(DA)
72 204 S(T/HMX-L.D)-.71 E -1.02 -1.11(AT ,)-.4 H 5.292(L=0)23.902 G
5.292(,1)-5.292 G 5.292(,.)-5.292 G 2.792(.., NL !)-5.292 F 10.292(:D)
47.792 G -1.11(AT)-10.692 G(/BMX-L.D)1.11 E -1.02 -1.11(AT ,)-.4 H 5.292
(L=0)23.902 G 5.292(,1)-5.292 G 5.292(,.)-5.292 G 2.791(.., NL !)-5.292
F 12.682(:d)72 216 S 5.182(at/knot.dat !)-12.682 F 17.682(LIBRARIES :)
12.682 F -.35(NA)12.682 G 5.182(G/FO2SDF !)-.05 F 12.682(:N)50.182 G -.4
(AG)-13.032 G 5.182(/F02FHF !).4 F(:)50.182 E -.35(NA)72 228 S(G/F07BDF)
-.05 E 2.597(,N)-.8 G -.4(AG)-2.947 G .097(/F07BEF !).4 F -.096 2.596
(:! S)45.096 H 17.596(UB/MOD :)-2.596 F .096
(modules.f90, sub_vhf.f, modio.f90 !)5.096 F 5.096(!!!)5.096 G 1.705
(h1e.f90 : !)72 240 R 1.705(1. Calculates ener)39.205 F 1.705
(gies + coef)-.18 F 1.705(\214cients for l = 0, 1, 2,..,nl !)-.25 F
1.706(for 1-e atomic)46.706 F -.05(hy)72 252 S 3.028
(drogenic systems with free boundary !).05 F 3.027
(conditions at the end of the interv)48.027 F 3.027(al [0, R].)-.25 F(!)
8.027 E -1 -.8(Tw o)72 264 T .462(methods ha)3.762 F .762 -.15(ve b)-.2
H .462(een emplo).15 F .462(yed : !)-.1 F .462(a. in)45.462 F -.15(ve)
-.4 G .462(rse iteration).15 F .463(\(FO2SDF\) !)35.463 F 1.263 -.4
(b. s)45.463 H(olu-).4 E .562(tion of linear systems !)72 276 R 38.061
(!2)5.561 G 3.061(.C)-38.061 G .561
(alculates and stores the 1-e Hamiltonian on Bsplines !)-3.061 F(as)
45.561 E .795(well as the B-splines o)72 288 R -.15(ve)-.15 G 3.295
(rlap. ! !).15 F .796(H_ij = < B_i | -d^2/dr^2 + V\(r\) | B_j > !)45.796
F .796(B_ij = <)45.796 F .068(B_i | B_j > !)72 300 R 5.068(!2)5.068 G
.068(003.02.05 !)-5.068 F 15.068(!t)5.068 G 2.568(ob)-15.068 G 2.567(ed)
-2.568 G .067(one: store the matrices in banded form directly !)-2.567 F
(instead)45.067 E .177(of calling full and then transform them into !)72
312 R .177(banded matrices !)45.177 F 5.177(!!)5.177 G .177
(nbs : nof bound states ! ncs :)-2.5 F(nof continuum states !)72 324 Q 0
Cg EP
PStoPSsaved restore
userdict/PStoPSsaved save put
PStoPSmatrix setmatrix
595.000000 421.271378 translate
90 rotate
0.706651 dup scale
userdict/PStoPSmatrix matrix currentmatrix put
userdict/PStoPSclip{0 0 moveto
 595.000000 0 rlineto 0 842.000000 rlineto -595.000000 0 rlineto
 closepath}put initclip
PStoPSxform concat
%%BeginPageSetup
BP
%%EndPageSetup
/F0 10/Times-Roman@0 SF(-3-)282.17 48 Q(CALL DIA)84.5 84 Q(GON)-.4 E
(ALIZE_DSBGV\( B, H0, V)-.35 E 2.5(,E)-1.29 G(N, CE\))-2.5 E
(!get en\(i\) and C\(i\))20 E 5(CALL ENERGY_SPECTR)84.5 96 R
(UM\( L0, EN, 'IN'\))-.4 E(ELSE IF\(method == ')77 132 Q(dl'\) THEN ! d\
iagonalization \(bound states\) + linear \(continuum states\) method)-.5
E(ALLOCA)84.5 168 Q(TE\( EN_B\(NL*\(NB-2\) \)\))-1.11 E(ALLOCA)84.5 180
Q(TE\( CE_B\(NB-2, NL*\(NB-1\)\) \))-1.11 E(CALL DIA)84.5 204 Q(GON)-.4
E(ALIZE_DSBGV\( B, H0, V)-.35 E 2.5(,E)-1.29 G(N_B, CE_B\))-2.5 E
(!get E\(n\) and C\(n\))25 E(nbs = 0)84.5 228 Q(DO i = 1, SIZE\(en_b\))
84.5 240 Q 2.5(!g)70 G(et nof of b)-2.5 E 2.5(.s)-.4 G
(tates by fxd conditions)-2.5 E(IF\(en_b\(i\) < 0.0_dpk\) nbs = nbs + 1)
92 252 Q(ENDDO)84.5 264 Q(WRITE\(*,*\) '# solv)84.5 288 Q 15
(e_banded_diag nbs)-.15 F 2.5(=')2.5 G 2.5(,n)-2.5 G(bs)-2.5 E
(IF\(spectrum=='fxd'\) THEN)84.5 312 Q 2.5(!n)5 G
(ote that here we need only eigen)-2.5 E -.25(va)-.4 G
(lues of the fxd problem.).25 E 2.5(!c)149.5 324 S
(alculate coe for E_n > 0 by linear)-2.5 E(-equation solv)-.2 E(er)-.15
E(ns = SIZE\(en_b\))92 336 Q 2.5(!\()20 G
(results should be the same as in ')-2.5 E(d' case)-.5 E(WRITE\(*,*\) ')
92 360 Q(ns = ', ns)22.5 E(ALLOCA)92 384 Q(TE\( EN\(NS\) \))-1.11 E
(ALLOCA)92 396 Q(TE\( CE\(NS, NL*\(NB-1\)\) \))-1.11 E(en = en_b)92 420
Q(CALL LINEARIZE_F07BEF\(H0, B, EN, CE\))92 444 Q 2.5(!s)17.5 G(olv)-2.5
E 2.5(ef)-.15 G(or E\(n\) > 0)-2.5 E(\(P\(R\) = 0\))5 E 2.5(!a)199.5 456
S(nd get)-2.5 E(C\(n\) by LE solv)7.5 E(er)-.15 E 7.5(ce\(1:nbs,:\) =)92
468 R(ce_b\(1:nbs,:\))2.5 E(DEALLOCA)92 492 Q(TE\( EN_B \))-1.11 E
(!en_b)10 E(DEALLOCA)92 504 Q(TE\( CE_B \))-1.11 E(!ce_b)10 E
(ELSE IF \(spectrum=='mxd'\) THEN)84.5 528 Q(ALLOCA)92 552 Q
(TE\( EN_C\(NCS\) \))-1.11 E(ALLOCA)92 564 Q
(TE\( CE_C\(NCS, NL*\(NB-1\)\) \))-1.11 E(CALL ENERGY_SPECTR)92 588 Q
(UM\(L0, EN_C, 'INOUT'\))-.4 E(!calculate en_c\(i\) \(do not store\))
22.5 E(CALL LINEARIZE_F07BEF\(H0, B, EN_C, CE_C\))92 600 Q(!solv)20 E
2.5(ef)-.15 G(or E > 0)-2.5 E(!and get)212 612 Q(C\(E\) by LE solv)5 E
(er)-.15 E(ns = nbs + ncs)92 624 Q(WRITE\(*,*\) "# h1e::)92 648 Q
(nbs = ", nbs)57.5 E(WRITE\(*,*\) "# h1e::)92 660 Q(ncs = ", ncs)57.5 E
(ALLOCA)92 684 Q(TE\( EN\(NS\) \))-1.11 E(ALLOCA)92 696 Q
(TE\( CE\(NS, NL*\(NB-1\)\) \))-1.11 E
(!... assemble bound and continuum results for E,C\(E\))72 720 Q 0 Cg EP
PStoPSsaved restore
%%Page: (6,7) 4
userdict/PStoPSsaved save put
PStoPSmatrix setmatrix
595.000000 0.271378 translate
90 rotate
0.706651 dup scale
userdict/PStoPSmatrix matrix currentmatrix put
userdict/PStoPSclip{0 0 moveto
 595.000000 0 rlineto 0 842.000000 rlineto -595.000000 0 rlineto
 closepath}put initclip
/PStoPSenablepage false def
PStoPSxform concat
%%BeginPageSetup
BP
%%EndPageSetup
/F0 10/Times-Roman@0 SF(-4-)282.17 48 Q 10(en\( 1)92 84 R 2.5(:n)2.5 G
(bs \) = en_b\( 1 : nbs\))-2.5 E 2.5(!e)27.5 G(ner)-2.5 E
(gy spectrum \(b + c\))-.18 E(en\( nbs+1 :)92 96 Q
(ns \) = en_c\( 1 : ncs\))5 E(!)92 108 Q 7.5(ce\( 1:)92 120 R 2.5
(nbs, :)2.5 F 2.5(\)=c)2.5 G(e_b\( 1 : nbs, : \))-2.5 E 2.5(!c)12.5 G
(oef)-2.5 E 7.5(\214cients \(b)-.25 F 2.5(+c)2.5 G(\))-2.5 E 2.5
(ce\(nbs+1: ns)92 132 R 2.5(,:\)=c)2.5 G(e_c\( 1 : ncs, : \))-2.5 E
(!...)72 156 Q(DEALLOCA)92 168 Q(TE\( EN_B \))-1.11 E(!en_b)10 E
(DEALLOCA)92 180 Q(TE\( CE_B \))-1.11 E(!ce_b)10 E(DEALLOCA)92 192 Q
(TE\( EN_C \))-1.11 E(!en_c)10 E(DEALLOCA)92 204 Q(TE\( CE_C \))-1.11 E
(!ce_c)10 E(ENDIF)84.5 228 Q(CALL ENERGY_SPECTR)84.5 252 Q
(UM\(L0, EN, 'IN'\))-.4 E 2.5(!g)22.5 G(et en\(i\) and store)-2.5 E
(ENDIF)77 276 Q 8.236(!D)72 300 S -1.21 -1.11(AT A)-8.636 H 3.237
(_FILE = "h1e-" !)1.11 F 3.237(IF\(code == 'bs_fx'\))8.237 F -.4(DA)
10.737 G -.93(TA)-.71 G 3.237(_FILE = "d1e-").93 F 5.737(!P)18.237 G
3.237(\(R\) == 0 !)-5.737 F(CALL)8.237 E(WRITE_V_MX\(L0, EN, CE, D)72
312 Q -1.21 -1.11(AT A)-.4 H(_FILE\))1.11 E(IF\(code == 'bs_fx'\) THEN)
77 348 Q 2.5(!P)42.5 G(\(R\) == 0)-2.5 E
(CALL WRITE_V_MX\(L0, EN, CE, "d1e-"\))84.5 360 Q(ELSE)77 372 Q
(CALL WRITE_V_MX\(L0, EN, CE, "h1e-"\))84.5 384 Q(ENDIF)77 396 Q 2.5
(!........................ DEALLOCA)77 432 R 2.5(TE ARRA)-1.11 F
(YS FOR L SYMMETR)-1.05 E(Y)-.65 E(DEALLOCA)77 456 Q(TE\( T \))-1.11 E
(DEALLOCA)77 468 Q(TE\( H0,B,V\))-1.11 E(DEALLOCA)77 480 Q(TE\( EN\))
-1.11 E(DEALLOCA)77 492 Q(TE\( CE\))-1.11 E
(WRITE\(*,*\) '# h1e:: Hamiltonian matrix:)77 528 Q 5(h\(ij\) =)17.5 F
2.5(<B)2.5 G(\(i\) | H | B\(j\) > : dat/hmx.dat')-2.5 E .801
(WRITE\(*,*\) '# h1e:: Hamiltonian matrix:)77 540 R 5.801(b\(ij\) =)
18.301 F 3.301(<B)3.301 G .801(\(i\) |B\(j\) >)-3.301 F 3.3(:d)15.8 G .8
(at/bmx.dat' !)-3.3 F .8(WRITE\(*,*\) '#)5.8 F(h1e:: ener)72 552 Q
(gies+coef)-.18 E(\214cients in: ',D)-.25 E -1.21 -1.11(AT A)-.4 H
(_FILE)1.11 E(WRITE\(*,*\) '# h1e:: end succesfully)77 576 Q -.7(.')-.65
G(WRITE\(*, '\(a2,1X,a42,i3\)'\) "#","!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!\
!!!!!!!!!!!!!!!!!!!!!!!!!!!")77 588 Q(CLOSE\(NOUT\))77 600 Q(CONT)72 624
Q 3.328(AINS !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!\
!!!!!!!!!!! \(he atomic problem\) !SUBR)-.93 F(OU-)-.4 E .933
(TINE MAKE_V_2E\(T)72 636 R 3.433(,V)-.74 G 3.432(\)!)-3.433 G .932
(REAL\(DPK\), DIMENSION\(:\),)-3.432 F 5.932(INTENT\(IN\) ::)10.932 F
3.432(T!)3.432 G .932(REAL\(DPK\), DIMEN-)-3.432 F 3.645
(SION\(:,:\), INTENT\(INOUT\)::)72 648 R 3.645(v!)3.645 G 1.145
(WRITE\(*,*\) ' h1e:: need to be implemented 31.03.2006' !END SUB-)
-3.645 F -.4(RO)72 660 S .906(UTINE MAKE_V_2E !!!!!!!!!!!!!!!!!!!!!!!!!\
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!! \(h2+ molecular prob-).4 F
(lem\) SUBR)72 672 Q(OUTINE MAKE_V_MOLECULAR\(T)-.4 E 2.5(,V)-.74 G(\))
-2.5 E(USE ang,)77 696 Q(only : cleb)20 E(USE utils,)77 708 Q
(only : print_mx)15 E(USE units,)77 720 Q(only : m_pi)15 E 0 Cg EP
PStoPSsaved restore
userdict/PStoPSsaved save put
PStoPSmatrix setmatrix
595.000000 421.271378 translate
90 rotate
0.706651 dup scale
userdict/PStoPSmatrix matrix currentmatrix put
userdict/PStoPSclip{0 0 moveto
 595.000000 0 rlineto 0 842.000000 rlineto -595.000000 0 rlineto
 closepath}put initclip
PStoPSxform concat
%%BeginPageSetup
BP
%%EndPageSetup
/F0 10/Times-Roman@0 SF(-17-)279.67 48 Q(ENDIF)97 84 Q(ENDDO)89.5 108 Q
(CLOSE\(NOUT\))89.5 132 Q(END SUBR)84.5 156 Q(OUTINE LINEARIZE_F07BEF)
-.4 E(!###########################################)82 168 Q(SUBR)82 180
Q(OUTINE ENERGY_SPECTR)-.4 E(UM\(L, EN, MODE\))-.4 E(USE param)87 204 Q
(USE D)87 216 Q -1.21 -1.11(AT A)-.4 H 2.5(,O)1.11 G(NL)-2.5 E 1.84 -.92
(Y: w)-1 H(rite_v).92 E(IMPLICIT NONE)87 240 Q(INTEGER L)87 264 Q
(REAL\(DPK\), DIMENSION\(:\), INTENT\(INOUT\) :: en)87 276 Q(INTEGER NS)
87 288 Q(CHARA)87 300 Q 2.5(CTER\(LEN=*\) MODE)-.4 F(!... locals)2.5 E
(INTEGER I)87 312 Q(!.....................)72 336 Q
(WRITE\(*,*\) '# ener)87 360 Q 7.5(gy_spectrum: size)-.18 F
(of en = ', size\(en\))2.5 E(ns = SIZE\(en\))87 384 Q
(IF \(MODE =='OUT'\) THEN)87 408 Q 2.5(DO I)94.5 432 R 2.5(=L+1,N)2.5 G
(S)-2.5 E(IF\(I.LE.NBS + L\) THEN)102 456 Q
(EN\(I\) = - 0.5D+00 * \(za/I\)**2)109.5 480 Q(ELSE IF\(I.LE.NS\) THEN)
102 504 Q(EN\(I\) =)109.5 528 Q 2.5(EN_1E +)7.5 F
(DE_1E * \( I - NBS - 1 - L\))10 E(ENDIF)102 552 Q(ENDDO)94.5 576 Q
(CALL write_v\(l, en, "en1e-"\))94.5 600 Q
(ELSE IF \(MODE =='INOUT'\) THEN)87 624 Q 2.5(!d)15 G 2.5(on)-2.5 G
(ot store)-2.5 E 2.5(DO I)94.5 648 R 2.5(=1,N)2.5 G(S)-2.5 E(EN\(I\) =)
102 660 Q 2.5(EN_1E +)7.5 F(DE_1E * \( I - 1\))10 E(ENDDO)94.5 672 Q
(ELSE IF \(MODE == 'IN'\) THEN)87 696 Q(CALL write_v\(l, en, "en1e-"\))
94.5 720 Q 0 Cg EP
PStoPSsaved restore
%%Page: (8,9) 5
userdict/PStoPSsaved save put
PStoPSmatrix setmatrix
595.000000 0.271378 translate
90 rotate
0.706651 dup scale
userdict/PStoPSmatrix matrix currentmatrix put
userdict/PStoPSclip{0 0 moveto
 595.000000 0 rlineto 0 842.000000 rlineto -595.000000 0 rlineto
 closepath}put initclip
/PStoPSenablepage false def
PStoPSxform concat
%%BeginPageSetup
BP
%%EndPageSetup
/F0 10/Times-Roman@0 SF(-16-)279.67 48 Q
(CALL X04CEF\(N, N, K, 2*K, A_E, 3*NL*KB-2,)92 84 Q
('X04CEF: A=PLU, U:', INFO\))-.7 E(ELSE)84.5 108 Q(C0 = 0.0D+00)92 132 Q
2.5(!i)60 G(nitialize C0)-2.5 E(C0\(NB-1, 1\) = 1.0D+00)92 144 Q
(IF\(ie.EQ.1\) THEN)92 168 Q(WRITE\(*,*\) '# c0 = ', ie,)99.5 180 Q
(SIZE\(c0, 1\), SIZE\(c0, 2\))5 E(ENDIF)92 192 Q
(CALL F07BEF\('N', N, K, K, 1, A_E, 3*NL*KB-2, IW)92 228 Q 2.5(,C)-.92 G
(0, N, INFO\))-2.5 E(ENDIF)97 252 Q(IF\(INFO.NE.0\) THEN)97 288 Q
(WRITE\(nout,*\) '#)104.5 300 Q(ERR)22.5 E(OR IN)-.4 E 22.5(F07BEF ')7.5
F(WRITE\(nout,*\) '#')104.5 312 Q(WRITE\(nout,*\) '#)104.5 324 Q
(INFO = ', INFO)52.5 E(WRITE\(nout,*\) '#')104.5 336 Q(ST)104.5 348 Q
(OP)-.18 E(ELSE)97 360 Q(WRITE\(nout, *\) '#)104.5 384 Q 10
(INPUT ENERGY)7.5 F 2.5(E=')15 G 2.5(,E)-2.5 G(N\(IE\))-2.5 E
(WRITE\(nout, *\) '#')104.5 396 Q(NORM = DO)104.5 432 Q(T_PR)-.4 E
(ODUCT\( C0\(:,1\), MA)-.4 E(TMUL\( B, C0\(:, 1\) \)\))-1.11 E 32.5(!C)
72 468 S(E\(IE,:\) = C\(:,1\) /SQR)-32.5 E(T\(NORM\))-.6 E 2.5(!t)104.5
504 S(ransform output v)-2.5 E
(ector from c_i\(l=0,1,..,nl\) ---> c_l\(i=1,2,..,nb-1\))-.15 E
(DO l = 1, nl)104.5 528 Q(DO j = 1, nb-1)112 540 Q
(CE\(ie,j +\(l-1\)*\(nb-1\)\) = C0\(l +\(j-1\)*nl,1\) /DSQR)119.5 564 Q
(T\(NORM\))-.6 E(ENDDO)112 588 Q(ENDDO)104.5 600 Q(ENDIF)97 624 Q
(WRITE\(NOUT)97 648 Q 2.5(,*)-.74 G 2.5(\)I)-2.5 G(E, EN\(IE\))-2.5 E
(IF\(IE.EQ.30.AND.L.EQ.0\) THEN)97 672 Q 2.5(DO J)104.5 684 R 2.5(=1)2.5
G 2.5(,\()-2.5 G(NB-1\)/2)-2.5 E(WRITE\(NOUT)112 708 Q 2.5(,")-.74 G(\(\
I4,1X,E25.14,2X,I4,1X,E25.14\)"\) J, CE\(IE,J\), J+NB/2, CE\(IE, J+NB/2\
\))-2.5 E(ENDDO)104.5 720 Q 0 Cg EP
PStoPSsaved restore
userdict/PStoPSsaved save put
PStoPSmatrix setmatrix
595.000000 421.271378 translate
90 rotate
0.706651 dup scale
userdict/PStoPSmatrix matrix currentmatrix put
userdict/PStoPSclip{0 0 moveto
 595.000000 0 rlineto 0 842.000000 rlineto -595.000000 0 rlineto
 closepath}put initclip
PStoPSxform concat
%%BeginPageSetup
BP
%%EndPageSetup
/F0 10/Times-Roman@0 SF(-5-)282.17 48 Q
(USE one_e_matrix, only:f !................................)77 84 Q(!)5
E(IMPLICIT NONE)77 108 Q 5(!!)72 132 S 2.5(declarations! !)-5 F
(REAL\(DPK\), DIMENSION\(:\),)77 156 Q 5(INTENT\(IN\) ::)10 F(T)2.5 E
(REAL\(DPK\), DIMENSION\(:,:\),)77 168 Q(INTENT\(INOUT\):: v ! locals !)
5 E(REAL\(DPK\), DIMENSION\(nb-1,nb-1,nl\) :: mx_r_lm)77 180 Q
(REAL\(DPK\), DIMENSION\(nl,nl,nl\))77 192 Q(:: f_g)12.5 E(aunt)-.05 E
(INTEGER i,j,il,jl)77 204 Q(INTEGER dim_h_1, dim_h_2)77 216 Q
(INTEGER la, lb, lm)77 228 Q(REAL\(DPK\) lab !)77 240 Q
(REAL\(DPK\) vlm !)5 E(EXTERN)5 E(AL f)-.35 E(!e)72 264 Q -.15(xe)-.15 G
(cutable part!....).15 E(WRITE\(*,*\) '# h1e::mak)77 276 Q 15
(e_v_molecular: call.)-.1 F 5('!!)-.7 G
(dim_h_1 = nl* SIZE\(mx_r_lm, 1\))77 288 Q
(dim_h_2 = nl* SIZE\(mx_r_lm, 1\) !)77 300 Q 2.5(!... !)5 F 2.5(!m)77
324 S(ak)-2.5 E 2.5(eg)-.1 G(aunt f)-2.55 E(actor)-.1 E(f_g)77 348 Q
(aunt = 0.0_dpk)-.05 E(la = l0)77 372 Q(DO il = 1, nl)77 384 Q(lb = l0)
84.5 408 Q(DO jl = 1, nl)84.5 432 Q 2.5(lab =)92 468 R
(\(2.0_dpk * DBLE\(la\) + 1\) * \(2.0_dpk * DBLE\(lb\) + 1\) !)2.5 E
(lm = 0)92 480 Q(DO l = 1, nl)92 492 Q 2.5(!s)12.5 G(um o)-2.5 E -.15
(ve)-.15 G 2.5(rL).15 G(f_g)99.5 516 Q(aunt\(il,jl,l\) = SQR)-.05 E 92.5
(T\(lab\) &)-.6 F 2.5(*c)142 528 S(leb\( 2*la,)-2.5 E(0, 2*lm, 0, 2*lb,)
12.5 E -2.5 7.5(0\) &)7.5 H 2.5(*c)142 540 S
(leb\( 2*la, 2*m_l, 2*lm, 0, 2*lb, 2*m_l \))-2.5 E(lm = lm + 2)99.5 552
Q(ENDDO !)97 564 Q(lb = lb + 2)92 576 Q(ENDDO !)84.5 588 Q(la = la + 2)
84.5 600 Q(ENDDO)77 612 Q(!)77 636 Q 2.5(!m)77 648 S(ak)-2.5 E 2.5(em)
-.1 G(olecular potential)-2.5 E 2.5(!m)77 660 S
(ix radial multipoles and angular f)-2.5 E(actors)-.1 E(!)77 672 Q
(lm = 0)77 696 Q(DO l = 1, nl)77 708 Q 0 Cg EP
PStoPSsaved restore
%%Page: (10,11) 6
userdict/PStoPSsaved save put
PStoPSmatrix setmatrix
595.000000 0.271378 translate
90 rotate
0.706651 dup scale
userdict/PStoPSmatrix matrix currentmatrix put
userdict/PStoPSclip{0 0 moveto
 595.000000 0 rlineto 0 842.000000 rlineto -595.000000 0 rlineto
 closepath}put initclip
/PStoPSenablepage false def
PStoPSxform concat
%%BeginPageSetup
BP
%%EndPageSetup
/F0 10/Times-Roman@0 SF(-6-)282.17 48 Q 2.5(CALL mat_bsp\(nb,)84.5 84 R
(t, mx_r_lm\(:,:,l\), f, lm, 0 \))2.5 E(!multipole e)5 E
(xpansion on B-splines)-.15 E(mx_r_lm\(:,:,l\) = -2.0_dpk * SQR)84.5 108
Q(T\(4.0_dpk * m_pi/\(2.0_dpk*l+1\)\) * mx_r_lm\(:,:,l\))-.6 E
(lm = lm + 2)84.5 132 Q(ENDDO)77 144 Q 2.5(V=0)77 180 S(.0_dpk)-2.5 E
(bsp_i: DO i = 1, nb-1)77 204 Q 5(bsp_j: DO)84.5 216 R 2.5(j=1,n)2.5 G
(b-1)-2.5 E(DO il = 1, nl)92 228 Q(DO jl = 1, nl)99.5 240 Q 35.49(!I)72
276 S .49(F\( il.NE.jl \) THEN !)-35.49 F .491(vlm = 0.0d+00 !)50.49 F
.491(DO l = 1, nl !)50.491 F .491(vlm =)57.991 F .445(vlm + f_g)72 288 R
.445(aunt\(il,jl,l\) * mx_r_lm\(i,j,l\) !)-.05 F .445(ENDDO !)50.445 F
.445(V\( \(i-1\)*nl+il, \(j-1\)*nl+jl\) = vlm)50.445 F 5(!!)72 300 S
(check the diagonal and non-diagonal parts L=0 --> 2/r !)-2.5 E
(IF\(il.NE.jl\) THEN)107 324 Q(V\( \(i-1\)*nl+il, \(j-1\)*nl+jl \) =)
114.5 336 Q(DO)5 E(T_PR)-.4 E(ODUCT\(mx_r_lm\(i,j,:\), f_g)-.4 E
(aunt\(il,jl,:\)\))-.05 E(ENDIF)107 348 Q 35(!E)72 372 S(LSE !)-35 E
(V\( \(i-1\)*nl+il, \(j-1\)*nl+jl \) =)42.5 E(0.0D+00 !)5 E(ENDIF)35 E
42.5(!E)72 408 S(NDIF)-42.5 E(ENDDO)99.5 444 Q(ENDDO !)92 456 Q
(ENDDO bsp_j)84.5 468 Q(ENDDO bsp_i !)77 480 Q(!)5 E
(IF\(print_out=='yes'\) THEN)77 492 Q(CALL print_mx\(dim_h_1, v)84.5 504
Q 2.5(,')-.65 G(v', 'e'\))-3 E(ENDIF)77 516 Q 1.35(END SUBR)72 540 R
1.35(OUTINE MAKE_V_MOLECULAR !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!\
!!!!!!!!!!!!!!! \(Magne-)-.4 F(tized h)72 552 Q(ydrogen\) SUBR)-.05 E
(OUTINE MAKE_V_MA)-.4 E(GNETIC\(T)-.4 E 2.5(,V)-.74 G(\))-2.5 E
(USE ang,)77 576 Q(only : cleb)22.5 E(USE utils,)77 588 Q
(only : print_mx)17.5 E
(USE one_e_matrix, only:f !......................)77 600 Q
(IMPLICIT NONE !)77 624 Q 2.5(!declarations! !)5 F
(REAL\(DPK\), DIMENSION\(:\),)77 636 Q 5(INTENT\(IN\) ::)10 F(T)2.5 E
(REAL\(DPK\), DIMENSION\(:,:\),)77 648 Q(INTENT\(INOUT\):: v !)5 E 2.5
(!l)5 G(ocals !)-2.5 E(!)5 E(REAL\(DPK\), DIMENSION\(nb-1,nb-1\))77 660
Q(:: mx_r0, mx_r2)10 E(REAL\(DPK\), DIMENSION\(nl,nl\))77 672 Q(:: vlm)
20 E(INTEGER i,j,il,jl)77 684 Q(INTEGER dim_h_1, dim_h_2)77 696 Q
(INTEGER la, lb)77 708 Q(REAL\(DPK\) lab)77 720 Q 0 Cg EP
PStoPSsaved restore
userdict/PStoPSsaved save put
PStoPSmatrix setmatrix
595.000000 421.271378 translate
90 rotate
0.706651 dup scale
userdict/PStoPSmatrix matrix currentmatrix put
userdict/PStoPSclip{0 0 moveto
 595.000000 0 rlineto 0 842.000000 rlineto -595.000000 0 rlineto
 closepath}put initclip
PStoPSxform concat
%%BeginPageSetup
BP
%%EndPageSetup
/F0 10/Times-Roman@0 SF(-15-)279.67 48 Q(!...)72 84 Q 5(K=)77 108 S
(NL *)-2.5 E(KB - 1)5 E 2.5(!n)25 G
(umber of sub-diagonials \(upper diagonals\))-2.5 E 5(N=)77 120 S
(NL * \(NB - 1\))-2.5 E 2.5(!d)22.5 G(imension of coef)-2.5 E
(\214cient v)-.25 E(ector)-.15 E(!...)72 144 Q(er = 1)77 168 Q 12.5
(!# GET)72 204 R(THE SYMMETRIC B)2.5 E(ANDED FORM OF THE A,B MA)-.35 E
(TRICES)-1.11 E(OPEN\(NOUT)77 240 Q 2.5(,F)-.74 G(ILE='out/subsolv)-2.5
E(e_lin.out'\))-.15 E(WRITE\(nout, *\) '#)77 264 Q(LINEAR SOLUTION : ')
17.5 E(!...)72 288 Q(dim = size\(en\))77 324 Q(dim_1 = SIZE\(ce,1\))77
336 Q(dim_2 = SIZE\(h, 1\))77 348 Q(WRITE\(*,*\) '# nof states)77 372 Q
(ns = ', dim_1, nbs + ncs)25 E(WRITE\(*,*\) '# nof basis)77 384 Q
(nc = ', dim_2, nl * \( nb - 1 \))27.5 E(CALL check\(dim_1, dim, er\))77
408 Q(CALL check\(dim_2, nl*\(nb-1\), er+1\))77 420 Q(DO ie = 1, dim)77
456 Q 2.5(!s)55 G(olv)-2.5 E 2.5(ef)-.15 G
(or 'ns' states: en\(ie\), ie = 1, ..., ns)-2.5 E 25(!... A\(E\))72 480
R 2.5(=H-E)2.5 G(*B)-2.5 E(DO J = 1, N)84.5 504 Q
(DO I = MAX\(1, J - K\), MIN\(N, J + K\))92 516 Q
(A_E\(2*K + I - J + 1, J\) = H\(I,J\) - EN\(IE\) * B\(I,J\))99.5 540 Q
(ENDDO)92 564 Q(ENDDO)84.5 576 Q(!... solv)72 612 Q 12.5(eA)-.15 G
(\(E\) * C = C0,)-12.5 E(IW = 0)84.5 636 Q
(CALL F07BDF\(N, N, K, K, A_E, 3*NL*KB-2, IW)84.5 648 Q 2.5(,I)-.92 G
12.5(NFO\) !)-2.5 F -.1(fa)2.5 G(ctorize).1 E(IF\(INFO.NE.0\) THEN)84.5
672 Q(WRITE\(*,*\) '# subsolv)92 696 Q(e:: f07bdf: Error in f)-.15 E
(actorization routine.)-.1 E(')-.7 E(WRITE\(*,*\) '# subsolv)92 708 Q
(e:: f07bdf:)-.15 E(info = ', info)62.5 E 0 Cg EP
PStoPSsaved restore
%%Page: (12,13) 7
userdict/PStoPSsaved save put
PStoPSmatrix setmatrix
595.000000 0.271378 translate
90 rotate
0.706651 dup scale
userdict/PStoPSmatrix matrix currentmatrix put
userdict/PStoPSclip{0 0 moveto
 595.000000 0 rlineto 0 842.000000 rlineto -595.000000 0 rlineto
 closepath}put initclip
/PStoPSenablepage false def
PStoPSxform concat
%%BeginPageSetup
BP
%%EndPageSetup
/F0 10/Times-Roman@0 SF(-14-)279.67 48 Q(WRITE\(*,*\) '# ERR)94.5 84 Q
(OR IN)-.4 E(DSBGV/LAP)5 E -.4(AC)-.92 G 2.5(KS).4 G(UBR)-2.5 E 7.5
(OUTINE, INFO)-.4 F 2.5(=')2.5 G 2.5(,I)-2.5 G(NFO)-2.5 E
(WRITE\(*,*\) '#')94.5 96 Q(ST)94.5 108 Q(OP)-.18 E(ELSE)87 120 Q
(OPEN\(10, \214le='out/en-dsbgv)94.5 144 Q(.out'\))-.65 E 2.5(DO I)94.5
156 R 2.5(=1,N)2.5 G(L*\(NB-2\))-2.5 E
(WRITE\(10,"\(I4,3X,3E20.10\)"\) I, EN\(I\))102 180 Q(ENDDO)94.5 204 Q
(CLOSE\(1\))94.5 216 Q(CE = TRANSPOSE\(Z\))94.5 240 Q
(!assign Z\(NB-2,NB-2\) ---> CE\(NB-2,NB-1\))42.5 E
(CE\(:, NL*\(NB-1\)\))94.5 252 Q 2.5(=0)5 G(.0D+00)-2.5 E
(DO i = 1, nl*\(nb-2\))94.5 276 Q(WRITE\(*,*\) i, -en\(i\), -2*en\(i\))
102 288 Q(ENDDO)94.5 300 Q(ENDIF)87 312 Q 113.535(END SUBR)82 348 R
113.535(OUTINE DIA)-.4 F(GON)-.4 E(ALIZE_DSBGV)-.35 E
(!f90f90f90f90f90f90f90f90f90f90f90f90f90f90f90f90f90f90f90f90f90f90f90)
72 360 Q(SUBR)82 372 Q(OUTINE LINEARIZE_F07BEF\(H, B, EN, CE\) !)-.4 E
(USE nag_f77_f_chapter)5 E(USE utils, ONL)77 384 Q 2.5(Y:c)-1 G(heck !)
-2.5 E(USE utils, ONL)5 E 2.5(Y:p)-1 G(rint_mx, check)-2.5 E
(!declarations!)72 408 Q(IMPLICIT NONE)77 420 Q
(REAL\(DPK\), DIMENSION\(:,:\),)77 432 Q(INTENT\(IN\) :: H)27.5 E
(REAL\(DPK\), DIMENSION\(:,:\),)77 444 Q(INTENT\(IN\) :: B)27.5 E
(REAL\(DPK\), DIMENSION\(:\),)77 456 Q(INTENT\(inout\) :: en)25 E
(REAL\(DPK\), DIMENSION\(:,:\),)77 468 Q(INTENT\(inout\) :: ce)20 E 2.5
(!l)72 492 S(ocals !)-2.5 E(INTEGER i, j !F07BEF!)77 504 Q(INTEGER K, N)
77 516 Q(REAL\(DPK\), DIMENSION\( 3*NL*KB-2, NL*\(NB-1\)\) :: A_E)77 528
Q 2.5(!l)5 G(inear)-2.5 E(REAL\(DPK\), DIMENSION\( NL*\(NB-1\),)77 540 Q
12.5(1\))10 G(:: C0)-10 E 5(INTEGER, DIMENSION\( NL*\(NB-1\))77 552 R
22.5(\):)2.5 G 2.5(:I)-22.5 G(W)-2.5 E(INTEGER INFO !)77 564 Q
(REAL\(dpk\) norm)77 576 Q(INTEGER l, ie)77 588 Q(INTEGER nout)77 600 Q
(INTEGER dim, dim_1, dim_2)77 612 Q(inte)77 624 Q(ger er)-.15 E(!e)72
648 Q -.15(xe)-.15 G 2.5(cutable! !...).15 F
(WRITE\(*,*\) '# h1e::linearize_f07bef:)77 660 Q(call.)45 E(')-.7 E
(!...)72 684 Q 10(NOUT =)77 708 R(12)2.5 E 0 Cg EP
PStoPSsaved restore
userdict/PStoPSsaved save put
PStoPSmatrix setmatrix
595.000000 421.271378 translate
90 rotate
0.706651 dup scale
userdict/PStoPSmatrix matrix currentmatrix put
userdict/PStoPSclip{0 0 moveto
 595.000000 0 rlineto 0 842.000000 rlineto -595.000000 0 rlineto
 closepath}put initclip
PStoPSxform concat
%%BeginPageSetup
BP
%%EndPageSetup
/F0 10/Times-Roman@0 SF(-7-)282.17 48 Q(REAL\(dpk\) r2, r0 !)77 84 Q
(REAL\(DPK\) h_b_o, h_l_m, h_b_m)5 E 2.5(!E)74.5 96 S(XTERN)-2.5 E(AL f)
-.35 E(!e)72 120 Q -.15(xe)-.15 G(cutable part!....).15 E
(WRITE\(*,*\) '# h1e::mak)77 132 Q 15(e_v_magnetic: call.)-.1 F 5('!s)
-.7 G(top)-5 E 2.5(CALL mat_bsp\()77 156 R(nb, t,)2.5 E 2.5(mx_r0, f,)
7.5 F(0, 0 \))2.5 E 2.5(!<B)7.5 G(_i | x^{0} | B_j)-2.5 E(>)5 E 2.5
(CALL mat_bsp\()77 168 R(nb, t,)2.5 E 2.5(mx_r2, f,)7.5 F(2, 0 \))2.5 E
2.5(!<B)10 G(_i | x^\(2\) | B_j)-2.5 E(>)5 E(!)72 192 Q
(dim_h_1 = nl* SIZE\(mx_r0, 1\))77 204 Q
(dim_h_2 = nl* SIZE\(mx_r0, 1\) !...)77 216 Q(!)5 E
(IF\(print_out=='yes'\) THEN)77 228 Q(WRITE\(*,*\) "# subsolv)84.5 240 Q
(e::solv)-.15 E 22.5(e_banded_lin: print)-.15 F(O,B:")2.5 E
(CALL print_mx\(nb-1, mx_r0,)84.5 252 Q('B', 'f)5 E('\)).55 E
(CALL print_mx\(nb-1, mx_r2,)84.5 264 Q('O', 'e'\))5 E(ENDIF)77 276 Q
2.714(!A)72 312 S .214(toms in strong magnetic \214elds, Ruder)-2.714 F
2.713(,W)-.4 G(unner)-3.213 E 2.713(,H)-.4 G .213(erold, Ge)-2.713 F
(yer)-.15 E 2.713(,S)-.4 G(pringer)-2.713 E 2.713(,B)-.4 G .213
(erlin, 1994 ! magnetic contri-)-2.713 F -.2(bu)72 324 S 1.014
(tion to \214eld-free h).2 F 1.014(ydrogenic hamiltonian ! l')-.05 F
23.515(s-coupling :)-.55 F 1.015(h_l_m !)3.515 F 1.015(\214eld-free h)
6.015 F 1.015(ydrogenic states are)-.05 F(reco)72 336 Q -.15(ve)-.15 G
(red if).15 E(b_f == 0)5 E 5(!!)72 372 S
(.... calculate vlm \214rst \(independent on B-splines basis\) !)-5 E
(la = l0)77 396 Q(DO il = 1, nl)77 408 Q(lb = l0)84.5 420 Q
(DO jl = 1, nl)84.5 432 Q
(lab = \(2.0D+00 * DBLE\(la\) + 1\)*\(2.0d+00 * DBLE\(lb\) + 1\))92 456
Q(vlm\(il,jl\) = SQR)92 480 Q 92.5(T\(lab\) &)-.6 F 2.5(*c)119.5 492 S
(leb\( 2*la,)-2.5 E(0, 4, 0, 2*lb,)12.5 E 5 7.5(0\) &)7.5 H 2.5(*c)119.5
504 S(leb\( 2*la, 2*m_l, 4, 0, 2*lb, 2*m_l \))-2.5 E(lb = lb + 2)92 540
Q(ENDDO)84.5 552 Q(la = la + 2)84.5 564 Q(ENDDO)77 576 Q 5(!!)72 600 S
2.5(... !)-5 F 2.5(V=0)77 624 S(.0d+00)-2.5 E(DO i = 1, nb-1)77 660 Q
(DO j =1 , nb-1)84.5 672 Q(r0 = mx_r0\(i,j\))92 696 Q(r2 = mx_r2\(i,j\))
92 708 Q 0 Cg EP
PStoPSsaved restore
%%Page: (14,15) 8
userdict/PStoPSsaved save put
PStoPSmatrix setmatrix
595.000000 0.271378 translate
90 rotate
0.706651 dup scale
userdict/PStoPSmatrix matrix currentmatrix put
userdict/PStoPSclip{0 0 moveto
 595.000000 0 rlineto 0 842.000000 rlineto -595.000000 0 rlineto
 closepath}put initclip
/PStoPSenablepage false def
PStoPSxform concat
%%BeginPageSetup
BP
%%EndPageSetup
/F0 10/Times-Roman@0 SF(-8-)282.17 48 Q(la = l0)92 84 Q(DO il = 1, nl)92
96 Q(lb = l0)99.5 120 Q(DO jl = 1, nl)107 144 Q(IF\( il == jl \) THEN)
114.5 168 Q(V\( \(i-1\)*nl+il, \(j-1\)*nl+jl\) = r2 * b_f**2 /3.0D+00)
122 204 Q 2.5(+r)7.5 G 2.5(0*b)-2.5 G(_f* \(m_l - 1\))-2.5 E(ELSE)107
228 Q 44.251(!l)72 252 S 1.751
(ab = \(2.0D+00 * DBLE\(la\) + 1\)*\(2.0d+00 * DBLE\(lb\) + 1\) !)
-44.251 F 1.75(h_l_m = sqrt\(lab\))44.25 F 49.558 2.942(&! *c)72 264 T
.442(leb\( 2*la,)-2.942 F .442(0, 4, 0, 2*lb,)12.942 F 4.557 7.943
(0\) &)7.943 H 57.943(!*)-5 G .443(cleb\( 2*la, 2*m_l, 4, 0, 2*lb,)-55 F
(2*m_l \) !)72 276 Q(V\( \(i-1\)*nl+il, \(j-1\)*nl+jl\) =)42.5 E 2.5(-r)
5 G 2.5(2*h)-2.5 G(_l_m * b_f**2 /3.0D+00)-2.5 E
(V\( \(i-1\)*nl+il, \(j-1\)*nl+jl\) =)114.5 300 Q 2.5(-r)5 G 2.5(2*v)
-2.5 G(lm\(il,jl\) * b_f**2 /3.0D+00)-2.5 E(ENDIF)107 324 Q(lb = lb + 2)
107 336 Q(ENDDO)99.5 348 Q(la = la + 2)99.5 360 Q(ENDDO)92 372 Q(ENDDO)
84.5 396 Q(ENDDO)77 408 Q(IF\(print_out=='yes'\) THEN)77 444 Q
(CALL print_mx\(dim_h_1, v)84.5 456 Q 2.5(,')-.65 G(v', 'e'\))-3 E
(ENDIF)77 468 Q 122.245(END SUBR)72 492 R 122.245(OUTINE MAKE_V_MA)-.4 F
(GNETIC)-.4 E 3.086
(!xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx B SUBR)72
504 R 3.087(OUTINE MAKE_B\(T)-.4 F(,)-.74 E(B\))72 516 Q(USE utils,)77
540 Q(only : print_mx)15 E
(USE one_e_matrix, only:f !......................)77 552 Q
(IMPLICIT NONE !declarations!)77 576 Q(REAL\(DPK\), DIMENSION\(:\),)77
588 Q 5(INTENT\(IN\) ::)10 F(T)2.5 E(REAL\(DPK\), DIMENSION\(:,:\),)77
600 Q(INTENT\(INOUT\):: b ! locals !)5 E
(REAL\(DPK\), DIMENSION\(nb-1,nb-1\))77 612 Q(:: mx_r0)20 E
(INTEGER i,j,il,jl)77 624 Q(INTEGER dim_h_1, dim_h_2)77 636 Q
(INTEGER la, lb)77 648 Q(REAL\(dpk\) r0 !)77 660 Q -.15(ex)5 G
(ternal f !e).15 E -.15(xe)-.15 G(cutable part!....).15 E 2.5
(CALL mat_bsp\()77 696 R(nb, t,)2.5 E 2.5(mx_r0, f,)5 F(0, 0 \))2.5 E
2.5(!<B)7.5 G(_i | r^0 | B_j)-2.5 E 2.5(>=<)5 G(B_i|B_j>)-2.5 E
(WRITE\(*,*\) '# h1e::mak)77 720 Q 15(e_B: call.)-.1 F 5('!)-.7 G 0 Cg
EP
PStoPSsaved restore
userdict/PStoPSsaved save put
PStoPSmatrix setmatrix
595.000000 421.271378 translate
90 rotate
0.706651 dup scale
userdict/PStoPSmatrix matrix currentmatrix put
userdict/PStoPSclip{0 0 moveto
 595.000000 0 rlineto 0 842.000000 rlineto -595.000000 0 rlineto
 closepath}put initclip
PStoPSxform concat
%%BeginPageSetup
BP
%%EndPageSetup
/F0 10/Times-Roman@0 SF(-13-)279.67 48 Q(REAL\(DPK\), DIMENSION\(:,:\),)
77 84 Q(INTENT\(IN\) :: V)12.5 E(REAL\(DPK\), DIMENSION\(:,:\),)77 96 Q
(INTENT\(INOUT\) :: CE)5 E(REAL\(DPK\), DIMENSION\(:\),)77 108 Q
(INTENT\(INOUT\) :: EN)10 E(!locals!)77 132 Q(INTEGER I, J)77 144 Q
(INTEGER N, K)77 156 Q 2.5(!D)77 180 S(SBGV/LAP)-2.5 E -.4(AC)-.92 G(K)
.4 E(REAL\(DPK\), DIMENSION\()77 192 Q(NL*KB, NL*\(NB-2\) \))5 E
(:: HB, BB)12.5 E(REAL\(DPK\), DIMENSION\()77 204 Q
(NL*\(NB-2\), NL*\(NB-2\) \) :: Z)5 E(!dsbgv)15 E
(REAL\(DPK\), DIMENSION\( 3*NL*\(NB-2\) \))77 216 Q(:: w)27.5 E(!dsbgv)
15 E(INTEGER INFO)77 228 Q(!e)72 252 Q -.15(xe)-.15 G(cutable part!).15
E(!...)72 276 Q(WRITE\(*,*\) '# h1e::diagonalize_dsbgv:)77 300 Q(call.)
7.5 E(')-.7 E(!...)72 324 Q 7.5(K=)77 348 S(NL *)-5 E(KB - 1)5 E 7.5(N=)
77 360 S(NL * \(NB - 2\))-5 E(!............................)72 384 Q
3.029(!h)72 408 S .529(b, bb, DIMENSION\()-3.029 F .529
(NL*KB, NL*\(NB-2\)\) !)5.529 F 3.029(!t)5.529 G .528
(ransform the \(n-1\)x\(n-1\) 'free' matrices to \(n-2\)x\(n-2\))-3.029
F('fxd' matrices ! equi)72 420 Q -.25(va)-.25 G
(lent to setting P\(R\) = 0 <=> or e).25 E(xcluding the B_n spline.)-.15
E(!)5 E(HB = 0.0D+00)87 444 Q(BB = 0.0D+00)87 456 Q(DO J = 1, N)87 480 Q
(DO I = MAX\(1, J - K\), J)94.5 492 Q(HB\( K + 1 + I - J, J \) =)102 504
Q(H0\(I, J\) + V\(I,J\))7.5 E(BB\( K + 1 + I - J, J \) =)102 516 Q
(B\(I, J\))7.5 E(ENDDO)94.5 528 Q(ENDDO)87 540 Q(!)87 564 Q 5(!D)87 576
S(SBGV/LAP)-5 E -.4(AC)-.92 G 5 2.5(K: A*C=e*B*C).4 H 10(,w)-2.5 G
(here, A,B banded real symmetric)-10 E(!)87 588 Q 7.5(!E)87 600 S 2.5
(VN)-7.5 G(ORMALIZED AS : Z^T * C * Z = 1)-2.5 E 7.5(!E)87 612 S
(N\(I\) <====> Z\(J,I\))-7.5 E(!)87 624 Q(INFO = 0)87 648 Q
(CALL DSBGV\('V', 'U', N, K, K, HB, K+1, BB, K+1, EN, Z, N, W)87 672 Q
2.5(,I)-.92 G(NFO\))-2.5 E(!...)87 696 Q(IF\(INFO.NE.0\) THEN)87 708 Q 0
Cg EP
PStoPSsaved restore
%%Page: (16,17) 9
userdict/PStoPSsaved save put
PStoPSmatrix setmatrix
595.000000 0.271378 translate
90 rotate
0.706651 dup scale
userdict/PStoPSmatrix matrix currentmatrix put
userdict/PStoPSclip{0 0 moveto
 595.000000 0 rlineto 0 842.000000 rlineto -595.000000 0 rlineto
 closepath}put initclip
/PStoPSenablepage false def
PStoPSxform concat
%%BeginPageSetup
BP
%%EndPageSetup
/F0 10/Times-Roman@0 SF(-12-)279.67 48 Q 8.325(!!)72 84 S 3.325
(hb, bb, DIMENSION\()-2.5 F 3.325(NL*KB, NL*\(NB-2\)\) !)8.325 F 5.825
(!t)8.325 G 3.325(ransform the \(n-1\)x\(n-1\) 'free' matrices to)-5.825
F(\(n-2\)x\(n-2\) 'fxd' matrices ! equi)72 96 Q -.25(va)-.25 G
(lent to setting P\(R\) = 0 <=> or e).25 E(xcluding the B_n spline.)-.15
E(!)5 E(HB = 0.0_dpk)77 120 Q(BB = 0.0_dpk)77 132 Q(DO J = 1, N)77 156 Q
(DO I = MAX\(1, J - K\), J)84.5 168 Q(HB\( K + 1 + I - J, J \) =)92 192
Q(H\(I, J\))7.5 E(BB\( K + 1 + I - J, J \) =)92 204 Q(B\(I, J\))7.5 E
(ENDDO)84.5 216 Q(ENDDO)77 228 Q 5(!d)77 264 S 7.5(iagonalize :)-5 F 5
(!F)77 276 S(O2FHF/N)-5 E -.4(AG)-.35 G(/M20 :).4 E 2.5(A*C=e*B*C)12.5 G
7.5(,w)-2.5 G(here, A,B banded real symmetric)-7.5 E(!)77 288 Q
(INFO = 0)77 324 Q -1.12 -.74(LW O)77 336 T
(RK = MAX\( NL*\(nb-2\), 4*\(NL*kB-1\)*\(2*NL*KB-1\)\)).74 E(!...)72 360
Q(CALL F02FHF\(N, K, HB, K+1, K, BB, K+1, EN, W)77 384 Q 2.5(,L)-.92 G
-.1(WO)-3.24 G(RK, INFO\)).1 E(!...)72 408 Q(IF\(INFO.NE.0\) THEN)77 432
Q(WRITE\(*,*\) '# ERR)84.5 456 Q(OR IN)-.4 E(F02FHF/N)5 E -.4(AG)-.35 G
(/M20 SUBR).4 E 7.5(OUTINE, INFO)-.4 F 2.5(=')2.5 G 2.5(,I)-2.5 G(NFO)
-2.5 E(WRITE\(*,*\) '#')84.5 468 Q(ST)84.5 480 Q(OP)-.18 E(ELSE)77 504 Q
(OPEN\(10, \214le='out/en-nag.out'\))84.5 528 Q 2.5(DO I)84.5 540 R 2.5
(=1,N)2.5 G(L*\(NB-2\))-2.5 E
(WRITE\(10,"\(I4,3X,3E20.10\)"\) I, EN\(I\))92 564 Q(ENDDO)84.5 588 Q
(CLOSE\(10\))84.5 600 Q(ENDIF)77 612 Q 118.53(END SUBR)72 636 R 118.53
(OUTINE DIA)-.4 F(GON)-.4 E(ALIZE_F02FHF)-.35 E 29.075(!!!!!!!!!!!!!!!!\
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!! SUBR)72 648
R 26.575(OUTINE DIA)-.4 F(GON)-.4 E(AL-)-.35 E(IZE_DSBGV\(B, H0, V)72
660 Q 2.5(,E)-1.29 G(N, CE\))-2.5 E(!declarations!)77 684 Q
(IMPLICIT NONE)77 696 Q(REAL\(DPK\), DIMENSION\(:,:\),)77 708 Q
(INTENT\(IN\) :: H0)12.5 E(REAL\(DPK\), DIMENSION\(:,:\),)77 720 Q
(INTENT\(IN\) :: B)12.5 E 0 Cg EP
PStoPSsaved restore
userdict/PStoPSsaved save put
PStoPSmatrix setmatrix
595.000000 421.271378 translate
90 rotate
0.706651 dup scale
userdict/PStoPSmatrix matrix currentmatrix put
userdict/PStoPSclip{0 0 moveto
 595.000000 0 rlineto 0 842.000000 rlineto -595.000000 0 rlineto
 closepath}put initclip
PStoPSxform concat
%%BeginPageSetup
BP
%%EndPageSetup
/F0 10/Times-Roman@0 SF(-9-)282.17 48 Q(dim_h_1 = nl* SIZE\(mx_r0, 1\))
77 84 Q(dim_h_2 = nl* SIZE\(mx_r0, 1\) !...)77 96 Q(!)5 E
(IF\(print_out=='yes'\) THEN)77 108 Q(WRITE\(*,*\) "# subsolv)84.5 120 Q
(e::solv)-.15 E 22.5(e_banded_lin: print)-.15 F(B:")2.5 E
(CALL print_mx\(nb-1, mx_r0,)84.5 132 Q('B', 'f)5 E('\)).55 E(ENDIF)77
144 Q 12.5(!# GET)72 168 R(THE SYMMETRIC B)2.5 E
(ANDED FORM OF THE A,B MA)-.35 E(TRICES)-1.11 E 2.5(!C)72 204 S
(onstruct the)-2.5 E(nl*\(nb-1\) x nl*\(nb-1\) o)5 E -.15(ve)-.15 G
(rlap matrix).15 E(BLMAX\(il;jl\) from)5 E(B\(nb-1,nb-1\))5 E 2.5(B=0)77
240 S(.0d+00)-2.5 E(DO i = 1, nb-1)77 264 Q(DO j =1 , nb-1)84.5 276 Q
(r0 = mx_r0\(i,j\))92 300 Q(la = l0)92 324 Q(DO il = 1, nl)92 336 Q
(lb = l0)99.5 360 Q(DO jl = 1, nl)107 384 Q(IF\( il == jl \) THEN)114.5
408 Q(B\( \(i-1\)*nl+il, \(j-1\)*nl+jl\) =)114.5 432 Q(r0)5 E(ELSE)107
456 Q(B\( \(i-1\)*nl+il, \(j-1\)*nl+jl\) =)114.5 480 Q(0.0D+00)5 E
(ENDIF)107 492 Q(lb = lb + 2)107 516 Q(ENDDO)99.5 528 Q(la = la + 2)99.5
540 Q(ENDDO)92 552 Q(ENDDO)84.5 576 Q(ENDDO)77 588 Q
(IF\(print_out=='yes'\) THEN)77 624 Q
(CALL print_mx\(dim_h_1, b, 'b', 'e'\))84.5 636 Q(ENDIF)77 648 Q 151.205
(END SUBR)72 672 R 151.205(OUTINE MAKE_B)-.4 F 51.58
(!!!xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx SUBR)
72 684 R(OUTINE)-.4 E(MAKE_H0\(T)72 696 Q 2.5(,H)-.74 G(0\))-2.5 E
(USE utils,)77 720 Q(only : print_mx)15 E 0 Cg EP
PStoPSsaved restore
%%Page: (18,19) 10
userdict/PStoPSsaved save put
PStoPSmatrix setmatrix
595.000000 0.271378 translate
90 rotate
0.706651 dup scale
userdict/PStoPSmatrix matrix currentmatrix put
userdict/PStoPSclip{0 0 moveto
 595.000000 0 rlineto 0 842.000000 rlineto -595.000000 0 rlineto
 closepath}put initclip
/PStoPSenablepage false def
PStoPSxform concat
%%BeginPageSetup
BP
%%EndPageSetup
/F0 10/Times-Roman@0 SF(-10-)279.67 48 Q
(USE one_e_matrix, only:f !......................)77 84 Q(IMPLICIT NONE)
77 108 Q(!declarations!)72 132 Q(REAL\(DPK\), DIMENSION\(:\),)77 144 Q 5
(INTENT\(IN\) ::)10 F(T)2.5 E(REAL\(DPK\), DIMENSION\(:,:\),)77 156 Q
(INTENT\(INOUT\):: h0 ! locals !)5 E
(REAL\(DPK\), DIMENSION\(nb-1,nb-1\))77 168 Q(:: mx_dr_0)20 E
(REAL\(DPK\), DIMENSION\(nb-1,nb-1\))77 180 Q(:: mx_r_1, mx_r_2)20 E
(INTEGER i,j,il,jl)77 192 Q(INTEGER dim_h_1, dim_h_2)77 204 Q
(INTEGER la, lb)77 216 Q(REAL\(dpk\) p2, r_2, r_1 !)77 228 Q -.15(ex)5 G
(ternal f).15 E(!!!....)72 252 Q 2.5(CALL mat_bsp\()77 276 R(nb, t,)2.5
E 2.5(mx_dr_0, f, 0,)5 F 2.5(1\) !<B)2.5 G('_i| 1)-2.5 E 2.5(|B)15 G
('_j >)-2.5 E 10(kinetic operator)12.5 F 2.5(CALL mat_bsp\()77 288 R
(nb, t,)2.5 E 2.5(mx_r_1, f,)7.5 F(-1, 0 \))2.5 E 2.5(!<B)7.5 G
(_i | x^{-1} | B_j)-2.5 E 10(>c)5 G 2.5(oulombing potential)-10 F 2.5
(CALL mat_bsp\()77 300 R(nb, t,)2.5 E 2.5(mx_r_2, f,)7.5 F(-2, 0 \))2.5
E 2.5(!<B)7.5 G(_i | x^\(-2\) | B_j)-2.5 E 10(>c)5 G(entrifug)-10 E
(al operator)-.05 E(!e)72 324 Q -.15(xe)-.15 G(cutable part!....).15 E
(WRITE\(*,*\) '# h1e::mak)77 348 Q 15(e_h: call.)-.1 F 5('!s)-.7 G
(top !)-5 E(dim_h_1 = nl* SIZE\(mx_dr_0, 1\))77 360 Q
(dim_h_2 = nl* SIZE\(mx_dr_0, 1\) !...)77 372 Q(!)5 E
(IF\(print_out=='yes'\) THEN)77 384 Q(WRITE\(*,*\) "# subsolv)84.5 396 Q
(e::solv)-.15 E 22.5(e_banded_lin: print)-.15 F(bp,v)2.5 E(,c:")-.65 E
(CALL print_mx\(nb-1, mx_dr_0, 'BP', 'e'\))84.5 408 Q
(CALL print_mx\(nb-1, mx_r_1,)84.5 420 Q('V', 'e'\))7.5 E
(CALL print_mx\(nb-1, mx_r_2,)84.5 432 Q('C', 'e'\))7.5 E(ENDIF)77 444 Q
2.5(!C)72 480 S(onstruct the)-2.5 E
(nl*\(nb-1\) x nl*\(nb-1\) hamiltonian)5 E
(H\(il;jl\) from h0\(nb-1,nb-1\), O,A)22.5 E(WRITE\(*,*\) '# mak)77 504
Q 20(e_h0:: b_f)-.1 F 2.5(=')2.5 G 2.5(,b)-2.5 G(_f)-2.5 E
(WRITE\(*,*\) '# mak)77 516 Q 22.5(e_h0:: l0)-.1 F 2.5(=')2.5 G 2.5(,l)
-2.5 G(0)-2.5 E(H0 = 0.0_dpk)77 552 Q(bsp_i: DO i = 1, nb-1)77 576 Q
(bsp_j: DO j =1 , nb-1)84.5 588 Q 5(p2 =)92 612 R(mx_dr_0\(i,j\))2.5 E
2.5(r_1 =)92 624 R(mx_r_1\(i,j\))2.5 E 2.5(r_2 =)92 636 R(mx_r_2\(i,j\))
2.5 E(la = l0)92 660 Q(DO il = 1, nl)92 672 Q(lb = l0)99.5 696 Q
(DO jl = 1, nl)107 720 Q 0 Cg EP
PStoPSsaved restore
userdict/PStoPSsaved save put
PStoPSmatrix setmatrix
595.000000 421.271378 translate
90 rotate
0.706651 dup scale
userdict/PStoPSmatrix matrix currentmatrix put
userdict/PStoPSclip{0 0 moveto
 595.000000 0 rlineto 0 842.000000 rlineto -595.000000 0 rlineto
 closepath}put initclip
PStoPSxform concat
%%BeginPageSetup
BP
%%EndPageSetup
/F0 10/Times-Roman@0 SF(-11-)279.67 48 Q(IF\( il == jl \) THEN)114.5 84
Q(H0\( \(i-1\)*nl+il, \(j-1\)*nl+jl\) = p2)122 96 Q 20
(/\(2.0_dpk*ma\) &)5 F 2.5(+r)197 108 S(_2 * la*\(la+1\)/2.0_dpk)-2.5 E
(&)7.5 E 2.5(-r)197 120 S(_1 * za)-2.5 E(ELSE)114.5 132 Q
(H0\( \(i-1\)*nl+il, \(j-1\)*nl+jl\) = 0.0_dpk)122 144 Q(ENDIF)107 156 Q
(lb = lb + 2)107 180 Q(ENDDO)99.5 192 Q(la = la + 2)99.5 204 Q(ENDDO)92
216 Q(ENDDO bsp_j)84.5 240 Q(ENDDO bsp_i)77 252 Q
(IF\(print_out=='yes'\) THEN)77 276 Q
(CALL print_mx\(dim_h_1, h0, 'h0', 'e'\))84.5 288 Q(ENDIF)77 300 Q 1.71
(END SUBR)72 324 R 1.71(OUTINE MAKE_H0 !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!\
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!)-.4 F(SUB-)6.71 E -.4(RO)
72 336 S(UTINE DIA).4 E(GON)-.4 E(ALIZE_F02FHF\(H,B\))-.35 E(USE ang,)77
360 Q(only : cleb)20 E(USE utils,)77 372 Q
(only : print_mx !......................)15 E(IMPLICIT NONE)77 396 Q
(!declarations!)72 420 Q
(REAL\(DPK\), DIMENSION\(:,:\), intent\(in\):: h)77 432 Q 2.5(!f)22.5 G
(ull matrix)-2.5 E(REAL\(DPK\), DIMENSION\(:,:\), intent\(in\):: b)77
444 Q 2.5(!f)22.5 G(ull matrix)-2.5 E 2.5(!l)72 468 S(ocals !)-2.5 E
(INTEGER I, J)77 480 Q(INTEGER N, K)77 492 Q(!F02FHF \(eigen)72 516 Q
-.25(va)-.4 G(lues only\)).25 E
(REAL\(DPK\), DIMENSION\( NL*KB, NL*\(NB-2\) \))77 528 Q(:: hb, bb)60 E
(!banded matrices)10 E(REAL\(DPK\), DIMENSION\( MAX\(NL*\(nb-2\),4*\(NL\
*kB-1\)*\(2*NL*KB-1\) \) \) :: w)77 540 Q
(REAL\(DPK\), DIMENSION\( NL*\(NB-2\) \))77 552 Q(:: en)77.5 E
(INTEGER L)77 564 Q -.1(WO)-.74 G(RK, INFO).1 E(!e)72 588 Q -.15(xe)-.15
G(cutable part!....).15 E(WRITE\(*,*\) '# h1e::solv)77 612 Q 15
(e_se_eigensystem_nag: call.)-.15 F(')-.7 E(!...)72 648 Q 7.5(K=)77 672
S(NL *)-5 E(KB - 1)5 E 7.5(N=)77 684 S(NL * \(NB - 2\))-5 E(!...)72 708
Q 0 Cg EP
PStoPSsaved restore
%%Trailer
end
%%EOF
